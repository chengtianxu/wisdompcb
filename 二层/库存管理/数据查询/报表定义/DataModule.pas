unit DataModule;

interface

uses
  SysUtils, Classes, DB, ADODB;

type
  TDM = class(TDataModule)
    ADOConnection1: TADOConnection;
    ADOdata0493: TADOQuery;
    ADOdata0493Company_Name: TStringField;
    ADOdata0493Company_Icon: TBlobField;
    ado207: TADOQuery;
    ado207GON_NUMBER: TStringField;
    ado207INV_PART_NUMBER: TStringField;
    ado207INV_PART_DESCRIPTION: TStringField;
    ado207GROUP_NAME: TStringField;
    ado207GROUP_DESC: TStringField;
    ado207DEPT_CODE: TStringField;
    ado207DEPT_NAME: TStringField;
    ado207TDATE: TDateTimeField;
    ado207QUANTITY: TFloatField;
    ado207RTN_QUANTITY: TFloatField;
    ado207STANDARD_COST: TFloatField;
    ado207CUT_NO: TStringField;
    ado207SO_NO: TStringField;
    ado207BARCODE_ID: TStringField;
    ADO22: TADOQuery;
    ADO22INV_PART_NUMBER: TStringField;
    ADO22GROUP_NAME: TStringField;
    ADO22quan_total: TFloatField;
    ADO22avl_price: TFloatField;
    ADO22amount: TFloatField;
    ADO22UNIT_CODE: TStringField;
    ado0022: TADOQuery;
    ado0022BARCODE_ID: TStringField;
    ado0022INV_PART_NUMBER: TStringField;
    ado0022INV_PART_DESCRIPTION: TStringField;
    ado0022GROUP_NAME: TStringField;
    ado0022WAREHOUSE_CODE: TStringField;
    ado0022code16: TStringField;
    ado0022GRN_NUMBER: TStringField;
    ado0022code23: TStringField;
    ado0022QUANTITY: TFloatField;
    ado0022QUAN_ON_HAND: TFloatField;
    ado0022QUAN_IN_INSP: TFloatField;
    ado0022CURR_CODE: TStringField;
    ado0022EXCHANGE_RATE: TFloatField;
    ado0022hkd_price: TFloatField;
    ado0022TDATE: TDateTimeField;
    ado0022EXPIRE_DATE: TDateTimeField;
    Aq53: TADOQuery;
    Aq53PROD_CODE: TStringField;
    Aq53quantity_hand: TFloatField;
    Aq53amount: TFloatField;
    ADO53: TADOQuery;
    ADO439: TADOQuery;
    ADO530: TADOQuery;
    ADO530MAWB_NO: TStringField;
    ADO530HAWB_NO: TStringField;
    ADO530FLIGHT_NO: TStringField;
    ADO530DEPA_DATE: TDateTimeField;
    ADO530delivery_no: TStringField;
    ADO530invoice_number: TStringField;
    ADO530CUST_CODE: TStringField;
    ADO530cartons_no: TIntegerField;
    ADO530charge: TFloatField;
    ADO530SALES_ORDER: TStringField;
    ADO530SHIPMENT_NO: TSmallintField;
    ADO530CUSTOMER_PART_NUMBER: TStringField;
    ADO530PO_NUMBER: TStringField;
    ADO530PO_DATE: TDateTimeField;
    ADO530QUAN_SHIPPED: TFloatField;
    ADO530part_price: TFloatField;
    ADO530amount: TFloatField;
    ADO112: TADOQuery;
    ADO0112: TADOQuery;
    AQ0070: TADOQuery;
    AQ0070po_number: TStringField;
    AQ0070PO_REV_NO: TStringField;
    AQ0070po_date: TDateTimeField;
    AQ0070PO_TYPE: TStringField;
    AQ0070PURCHASE_ORDER_TYPE: TWordField;
    AQ0070empl_code: TStringField;
    AQ0070employee_name: TStringField;
    AQ0070code: TStringField;
    AQ0070supplier_name: TStringField;
    AQ0070v_status: TStringField;
    AQ0070v_type: TStringField;
    AQ0070shipping_cost: TFloatField;
    AQ0070MISC_CHARGE: TFloatField;
    AQ0070SUPP_FAC_ADD_PTR: TIntegerField;
    AQ0070PAYMENT_TERMS: TSmallintField;
    ADO70: TADOQuery;
    ADO70PO_NUMBER: TStringField;
    ADO70EXCHANGE_RATE: TFloatField;
    ADO70SHIPPING_COST: TFloatField;
    ADO70FEDERAL_TAX: TFloatField;
    ADO70SUB_TOTAL: TFloatField;
    ADO70CONFIRMATION_NUMBER: TStringField;
    ADO70SHIPPING_METHOD: TStringField;
    ADO70PO_DATE: TDateTimeField;
    ADO70SUPPIER_CONTACT: TStringField;
    ADO70CONTACT_PHONE: TStringField;
    ADO70DISCOUNT_AMOUNT: TFloatField;
    ADO70DATE_EDITED: TDateTimeField;
    ADO70PO_TYPE: TStringField;
    ADO70FOB: TStringField;
    ADO70MISC_CHARGE: TFloatField;
    ADO70PRINT_DATE: TDateTimeField;
    ADO70PRINT_TIME: TDateTimeField;
    ADO70MULTIPLE_FACTOR: TFloatField;
    ADO70PO_REV_NO: TStringField;
    ADO70CASH_DISCOUNT: TFloatField;
    ADO70DISCOUNT_DAYS: TSmallintField;
    ADO70CASH_DISCOUNT2: TFloatField;
    ADO70DISCOUNT2_DAYS: TSmallintField;
    ADO70ANALYSIS_CODE_1: TStringField;
    ADO70ANALYSIS_CODE_2: TStringField;
    ADO70ANALYSIS_CODE_3: TStringField;
    ADO70ANALYSIS_CODE_4: TStringField;
    ADO70ANALYSIS_CODE_5: TStringField;
    ADO70curr_code: TStringField;
    ADO70curr_name: TStringField;
    ADO70factory_location: TStringField;
    ADO71: TADOQuery;
    ADO71QUAN_ORD: TFloatField;
    ADO71QUAN_RECD: TFloatField;
    ADO71QUAN_IN_INSP: TFloatField;
    ADO71QUAN_RETN: TFloatField;
    ADO71QUAN_INVD: TFloatField;
    ADO71PRICE: TFloatField;
    ADO71TAX_2: TFloatField;
    ADO71DISCOUNT: TFloatField;
    ADO71DEL_DATE: TDateTimeField;
    ADO71REQ_DATE: TDateTimeField;
    ADO71QUAN_REJD: TFloatField;
    ADO71WO_PTR: TIntegerField;
    ADO71PURCHASE_UNIT_PTR: TIntegerField;
    ADO71CONVERSION_FACTOR: TFloatField;
    ADO71PRINTED_DATE: TDateTimeField;
    ADO71inv_part_number: TStringField;
    ADO71inv_part_description: TStringField;
    ADO71std_price: TFloatField;
    ADO71sim_total: TFloatField;
    ADO71tax_total: TFloatField;
    ADO71price_discount: TFloatField;
    ADO107011: TADOQuery;
    ADOQuery2: TADOQuery;
    ADO200: TADOQuery;
    ADO200RKEY: TAutoIncField;
    ADO200POPTR: TIntegerField;
    ADO200MISC_CHARGE_PTR: TIntegerField;
    ADO200AMOUNT: TFloatField;
    ADO200TAXABLE: TStringField;
    ADO72: TADOQuery;
    ADO72DESCRIPTION: TStringField;
    ADO72QUAN_ORD: TFloatField;
    ADO72QUAN_INVD: TFloatField;
    ADO72UNIT_PRICE: TFloatField;
    ADO72STATE_TAX: TFloatField;
    ADO72GL_PTR: TIntegerField;
    ADO72QUANTITY_RECEIVED: TFloatField;
    ADO72DESCRIPTION2: TStringField;
    ADO72DEL_DATE: TDateTimeField;
    ADO72UNIT_PTR: TIntegerField;
    ADO72PRINTED_DATE: TDateTimeField;
    ADO72sim_total: TFloatField;
    ADO72tax_total: TFloatField;
    ado0022PO_NUMBER: TStringField;
    ADO71UNIT_NAME: TStringField;
    ado0017: TADOQuery;
    ADO72unit_name: TStringField;
    ado0017rkey: TAutoIncField;
    ado0017inv_part_number: TStringField;
    ado0017INV_PART_DESCRIPTION: TStringField;
    AQ0070fob: TStringField;
    AQ0070sub_total: TFloatField;
    AQ0070EXCHANGE_RATE: TFloatField;
    AQ0015: TADOQuery;
    AQ0015WAREHOUSE_CODE: TStringField;
    AQ0015WAREHOUSE_NAME: TStringField;
    AQ0015ENG_NAME: TStringField;
    AQ0015ABBR_NAME: TStringField;
    AQ0015ADDRESS_LINE_1: TStringField;
    AQ0015ADDRESS_LINE_2: TStringField;
    AQ0015ADDRESS_LINE_3: TStringField;
    AQ0015STATE: TStringField;
    AQ0015ZIP: TStringField;
    AQ0015PHONE: TStringField;
    AQ0015FAX: TStringField;
    AQ0015TELEX: TStringField;
    AQ0015WEB: TStringField;
    AQ0015EMPLOYEE_PTR_1: TIntegerField;
    AQ0015EMPLOYEE_PTR_2: TIntegerField;
    AQ0015EMPLOYEE_PTR_3: TIntegerField;
    AQ0015WAREHOUSE_TYPE: TWordField;
    AQ0015o_warehouse_name: TStringField;
    AQ0015o_eng_name: TStringField;
    AQ0015o_address_1: TStringField;
    AQ0015o_address_2: TStringField;
    AQ0015o_address_3: TStringField;
    AQ0015o_state: TStringField;
    AQ0015o_zip: TStringField;
    AQ0015o_phone: TStringField;
    AQ0015o_fax: TStringField;
    AQ0015o_telex: TStringField;
    AQ0015o_web: TStringField;
    AQ0015purchase_order: TStringField;
    AQ0015o_purchase_order: TStringField;
    AQ0015picture: TBlobField;
    AQ0015o_picture: TBlobField;
    ADO107011NOTE_PAD_LINE_1: TStringField;
    ADO107011NOTE_PAD_LINE_2: TStringField;
    ADO107011NOTE_PAD_LINE_3: TStringField;
    ADO107011NOTE_PAD_LINE_4: TStringField;
    ADO72GUI_GE: TStringField;
    ado0017inv_name: TStringField;
    ado0017inv_description: TStringField;
    ADO71inv_number: TStringField;
    ADO22inv_name: TStringField;
    ADO22INV_DESCRIPTION: TStringField;
    ADO22ABBR_NAME: TStringField;
    ADO71reason: TStringField;
    ADO71extra_req: TStringField;
    ADO71invpart_desc: TStringField;
    ADO70SHIPTO_ADDRESS: TStringField;
    ADO70PURCHASE_TYPE: TStringField;
    AQ0070status: TWordField;
    ADO70STATE_SHIP_TAX_FLAG: TStringField;
    ADO70STATE_MISC_TAX_FLAG: TStringField;
    ADO70SUPP_FAC_ADD_PTR: TIntegerField;
    ADO7011: TADOQuery;
    ADO7011NOTE_PAD_LINE_1: TStringField;
    ADO7011NOTE_PAD_LINE_2: TStringField;
    ADO7011NOTE_PAD_LINE_3: TStringField;
    ADO7011NOTE_PAD_LINE_4: TStringField;
    ADOdata0493Company_Name2: TStringField;
    ADOdata0493Company_Name3: TStringField;
    ADOdata0493ship_address: TStringField;
    ADOdata0493SITE_INFO_ADD_1: TStringField;
    ADOdata0493SITE_INFO_ADD_2: TStringField;
    ADOdata0493SITE_INFO_ADD_3: TStringField;
    ADOdata0493SITE_INFO_PHONE: TStringField;
    AQ0070phone: TStringField;
    AQ0070fax: TStringField;
    ADO0450: TADOQuery;
    Aq53abbr_name10: TStringField;
    Aq53mianji: TFloatField;
    ADO71tax_price: TFloatField;
    ADO71tax_price_dic: TFloatField;
    ADO71taxprice_total: TFloatField;
    ADO72reason: TStringField;
    ADO72tax_price: TFloatField;
    ADO72taxprice_total: TFloatField;
    ADO71INVT_PTR: TIntegerField;
    ADO71invdesc_extra: TStringField;
    ADO71rohs: TStringField;
    ADO72rohs: TStringField;
    ado52: TADOQuery;
    ado52SALES_ORDER: TStringField;
    ado52delivery_no: TStringField;
    ado52PROD_CODE: TStringField;
    ado52CUST_CODE: TStringField;
    ado52WAREHOUSE_CODE: TStringField;
    ado52CODE: TStringField;
    ado52QUAN_SHP: TFloatField;
    ado52out_mianji: TFloatField;
    ado52part_price: TFloatField;
    ado52amount: TFloatField;
    ado52SHIPMENT_NO: TSmallintField;
    ado52WORK_ORDER_NUMBER: TStringField;
    ado52EXCH_RATE: TFloatField;
    ado52DATE_ASSIGN: TDateTimeField;
    ado52date_shipped: TDateTimeField;
    ado52out_weight: TFloatField;
    ado52so_mianji: TFloatField;
    ado52PO_NUMBER: TStringField;
    ado52taxpart_price: TFloatField;
    ado52taxamount: TFloatField;
    ado52RMA_PTR: TIntegerField;
    ado52intype: TStringField;
    ado52ANALYSIS_CODE_2: TStringField;
    ADO53WORK_ORDER_NUMBER: TStringField;
    ADO53PROD_CODE: TStringField;
    ADO53ABBR_NAME: TStringField;
    ADO53WAREHOUSE_CODE: TStringField;
    ADO53LOCATION: TStringField;
    ADO53QUANTITY: TFloatField;
    ADO53number: TStringField;
    ADO53type: TWordField;
    ADO53in_mianqi: TFloatField;
    ADO53so_mianqi: TFloatField;
    ADO53QTY_ON_HAND: TFloatField;
    ADO53MFG_DATE: TDateTimeField;
    ADO53REFERENCE_NUMBER: TStringField;
    ADO53RMA_PTR: TIntegerField;
    ADO53inweight: TFloatField;
    ADO53MANU_PART_NUMBER: TStringField;
    ADO53MANU_PART_DESC: TStringField;
    ADO53ANALYSIS_CODE_2: TStringField;
    ADO53LATEST_PRICE: TFloatField;
    ADO53TAXLATEST_PRICE: TFloatField;
    ADO53exch_rate: TFloatField;
    ADO53so_no: TStringField;
    ADO53zhuanchang: TStringField;
    ADO53c_type: TStringField;
    ado52PRODUCT_NAME: TStringField;
    ado52ABBR_NAME: TStringField;
    ado52MANU_PART_NUMBER: TStringField;
    ado52MANU_PART_DESC: TStringField;
    Aq53so_mianji: TFloatField;
    Aq53MANU_PART_NUMBER: TStringField;
    Aq53MANU_PART_DESC: TStringField;
    ADO439delivery_no: TStringField;
    ADO439CUST_CODE: TStringField;
    ADO439date_sailing: TDateTimeField;
    ADO439cartons_no: TIntegerField;
    ADO439charge: TFloatField;
    ADO439SALES_ORDER: TStringField;
    ADO439fob: TStringField;
    ADO439SCH_DATE: TDateTimeField;
    ADO439SHIPMENT_NO: TSmallintField;
    ADO439MANU_PART_NUMBER: TStringField;
    ADO439PO_NUMBER: TStringField;
    ADO439PO_DATE: TDateTimeField;
    ADO439reference_number: TStringField;
    ADO439EMPLOYEE_NAME: TStringField;
    ADO439QUAN_SHIPPED: TIntegerField;
    ADO439part_price: TFloatField;
    ADO439Remark: TStringField;
    ADO439weigth: TBCDField;
    ADO439ANALYSIS_CODE_2: TStringField;
    ADO439amount: TFloatField;
    ADO439invoice_number: TStringField;
    ADO439MANU_PART_DESC: TStringField;
    ADO439mianji: TFloatField;
    ADO0112invoice_number: TStringField;
    ADO0112INVOICE_TOTAL: TBCDField;
    ADO0112CUST_CODE: TStringField;
    ADO0112INVOICE_DATE: TDateTimeField;
    ADO0112SALES_ORDER: TStringField;
    ADO0112MANU_PART_NUMBER: TStringField;
    ADO0112PO_NUMBER: TStringField;
    ADO0112PO_DATE: TDateTimeField;
    ADO0112due_date: TDateTimeField;
    ADO0112ship_tax_amount: TBCDField;
    ADO0112TOOLING_CHARGES: TBCDField;
    ADO0112total_paid_amount: TBCDField;
    ADO0112EXCHANGE_RATE: TFloatField;
    ADO0112CURR_CODE: TStringField;
    ADO0112DSDesigner: TStringField;
    ADO0112DSDesigner2: TStringField;
    ADO112invoice_number: TStringField;
    ADO112EMPLOYEE_NAME: TStringField;
    ADO112CURR_CODE: TStringField;
    ADO112EXCHANGE_RATE: TFloatField;
    ADO112ship_amount: TBCDField;
    ADO112DISCOUNT_AMOUNT: TBCDField;
    ADO112SHIPPING_CHARGES: TBCDField;
    ADO112FED_TAX_AMOUNT: TBCDField;
    ADO112INVOICE_TOTAL: TBCDField;
    ADO112total_paid_amount: TBCDField;
    ADO112delivery_no: TStringField;
    ADO112INVOICE_DATE: TDateTimeField;
    ADO112due_date: TDateTimeField;
    ADO112date_sailing: TDateTimeField;
    ADO112shipping_method: TStringField;
    ADO112DSDesigner: TStringField;
    procedure ADO71CalcFields(DataSet: TDataSet);
    procedure ADO72CalcFields(DataSet: TDataSet);
    procedure AQ0070CalcFields(DataSet: TDataSet);
    procedure ado52CalcFields(DataSet: TDataSet);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  DM: TDM;

implementation

{$R *.dfm}

procedure TDM.ADO71CalcFields(DataSet: TDataSet);
begin

 dm.ADO71tax_price_dic.Value := dm.ADO71tax_price.Value*(1-dm.ADO71DISCOUNT.Value*0.01);//含税折扣价
 dm.ADO71std_price.Value := dm.ADO71PRICE.Value*(1-dm.ADO71DISCOUNT.Value*0.01);

 dm.ADO71sim_total.Value := dm.ADO71QUAN_ORD.Value*dm.ADO71std_price.Value;

 dm.ADO71taxprice_total.Value:= dm.ADO71QUAN_ORD.value*dm.ADO71tax_price_dic.value;

 dm.ADO71tax_total.Value := dm.ADO71QUAN_ORD.Value*dm.ADO71std_price.Value-dm.ADO71sim_total.Value;
 dm.ADO71price_discount.Value := dm.ADO71QUAN_ORD.Value*dm.ADO71PRICE.Value*
                                 dm.ADO71DISCOUNT.Value*0.01;//价格折扣
 dm.ADO71invdesc_extra.Value := trim(dm.ADO71invpart_desc.AsString)+
                                trim(dm.ADO71extra_req.AsString);
end;

procedure TDM.ADO72CalcFields(DataSet: TDataSet);
begin
 dm.ADO72sim_total.Value := dm.ADO72QUAN_ORD.Value*dm.ADO72UNIT_PRICE.Value;
 dm.ADO72tax_price.Value:=dm.ADO72UNIT_PRICE.Value*(1+dm.ADO72STATE_TAX.Value*0.01);
 dm.ADO72taxprice_total.Value:=dm.ADO72QUAN_ORD.Value*dm.ADO72tax_price.Value;
 dm.ADO72tax_total.Value := dm.ADO72sim_total.Value*dm.ADO72STATE_TAX.Value*0.01;
end;

procedure TDM.AQ0070CalcFields(DataSet: TDataSet);
begin
 case dm.AQ0070status.Value of
  1: dm.AQ0070v_status.Value := '待审核';
  2: dm.AQ0070v_status.Value := '已取消';
  3: dm.AQ0070v_status.Value := '已保留';
  4: dm.AQ0070v_status.Value := '已暂缓';
  5: dm.AQ0070v_status.Value := '已审核';
  6: dm.AQ0070v_status.Value := '已收货';
  7: dm.AQ0070v_status.Value := '已完成';
 end;
 if dm.AQ0070PO_TYPE.Value = 'S' then
  case dm.AQ0070PURCHASE_ORDER_TYPE.Value of
   0: dm.AQ0070v_type.Value := '标准';
   1: dm.AQ0070v_type.Value := '覆盖';
   2: dm.AQ0070v_type.Value := '寄售';
  end
 else
  dm.AQ0070v_type.Value := '杂项';
end;

procedure TDM.ado52CalcFields(DataSet: TDataSet);
begin
 case self.Ado52rma_ptr.Value of
  0:self.Ado52intype.Value:='正常过数入仓';
  1:self.Ado52intype.Value:='退货重检入仓';
  2:self.Ado52intype.Value:='返修重检入仓';
  3:self.Ado52intype.Value:='直接入仓';
  4:self.Ado52intype.Value:='委外加工入仓';
  5:self.Ado52intype.Value:='委外加工退货入仓';
  6:self.Ado52intype.Value:='销售退货入仓';
  7:self.Ado52intype.Value:='转换入仓';
  8:self.Ado52intype.Value:='盘点入仓';
 end;
end;

end.
